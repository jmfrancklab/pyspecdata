<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2D ILT test &#8212; pySpecData 0.9.5.3.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=832af5b0" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2b30a6e6" />
    <script src="../_static/documentation_options.js?v=5b73e601"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Individual Functions" href="indiv_funcs/index.html" />
    <link rel="prev" title="Quantitative ESR" href="QESR.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-nddata-nnls-tikhonov-190104-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="d-ilt-test">
<span id="sphx-glr-auto-examples-nddata-nnls-tikhonov-190104-py"></span><h1>2D ILT test<a class="headerlink" href="#d-ilt-test" title="Link to this heading">Â¶</a></h1>
<p>2D regularization test</p>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_nddata_NNLS_Tikhonov_190104_001.png" srcset="../_images/sphx_glr_nddata_NNLS_Tikhonov_190104_001.png" alt="True $T_{1}$,$T_{2}$" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_nddata_NNLS_Tikhonov_190104_002.png" srcset="../_images/sphx_glr_nddata_NNLS_Tikhonov_190104_002.png" alt="2D test data" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_nddata_NNLS_Tikhonov_190104_003.png" srcset="../_images/sphx_glr_nddata_NNLS_Tikhonov_190104_003.png" alt="Solution" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>----------  logging output to /home/jmfranck/pyspecdata.0.log  ----------
not in notebook, calling show
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">magic</span><span class="p">(</span><span class="s1">&#39;load_ext pyspecdata.ipy&#39;</span><span class="p">)</span>
    <span class="n">in_notebook</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pyspecdata</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="n">in_notebook</span> <span class="o">=</span> <span class="kc">False</span>
<span class="kn">from</span> <span class="nn">pyspecdata</span> <span class="kn">import</span> <span class="n">nnls_regularized</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">time</span>
<a href="../modules.html#module-pyspecdata.figlist" title="pyspecdata.figlist" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-module"><span class="n">fl</span></a><span class="o">=</span><a href="../modules.html#module-pyspecdata.figlist" title="pyspecdata.figlist" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-module"><span class="n">figlist_var</span></a><span class="p">()</span>
<span class="n">init_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>


<span class="c1"># got the following from here:</span>
<span class="c1"># https://medium.com/pythonhive/python-decorator-to-measure-the-execution-time-of-methods-fa04cb6bb36d</span>

<span class="c1">#l_line = &#39;&#39;</span>
<span class="c1">#def timeit(method,n_times=5):</span>
<span class="c1">#    def timed(*args, **kw):</span>
<span class="c1">#        timing = zeros(n_times+1)</span>
<span class="c1">#        timing[0] = time.time()</span>
<span class="c1">#        for j in range(n_times):</span>
<span class="c1">#            result = method(*args, **kw)</span>
<span class="c1">#            timing[j+1] = time.time()</span>
<span class="c1">#        time_diff = (timing[-1]-timing[0])/float(n_times)</span>
<span class="c1">#        if &#39;log_time&#39; in kw:</span>
<span class="c1">#            name = kw.get(&#39;log_name&#39;, method.__name__.upper())</span>
<span class="c1">#            kw[&#39;log_time&#39;][name] = int(time_diff * 1000)</span>
<span class="c1">#        else:</span>
<span class="c1">#            print(&#39;%r  %2.2f ms (average of %d runs)&#39; %(method.__name__, time_diff * 1000, n_times) + l_line)</span>
<span class="c1">#        return result</span>
<span class="c1">#    return timed</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#R = r_[1.:100:500j] # distribution of T2 relaxation rates</span>
<span class="c1">#peaks = [(80,4,1),(20,0.5,0.5),(30,0.5,0.25)]</span>
<span class="c1">#calcd = False</span>
<span class="c1">#for mu,sigma,A in peaks:</span>
<span class="c1">#    if not calcd:</span>
<span class="c1">#        P = A*exp(-(R-mu)**2/(2*sigma**2))</span>
<span class="c1">#        calcd = True</span>
<span class="c1">#    else:</span>
<span class="c1">#        P += A*exp(-(R-mu)**2/(2*sigma**2))</span>
<span class="c1">#P = nddata(P,&#39;R&#39;)</span>
<span class="c1">#print(&quot;your labels are&quot;,P.dimlabels)</span>
<span class="c1">#P.setaxis(&#39;R&#39;,R.ravel())</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## Vary R as we move along the rows</span>
<span class="c1">#</span>
<span class="c1">#fl.next(&#39;distribution function&#39;)</span>
<span class="c1">#fl.plot(P)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#time_endpoint = 0.2</span>
<span class="c1">#t = nddata(r_[1e-3:time_endpoint:2048j],&#39;t&#39;) # column vectors give functions of time</span>
<span class="c1">#R = P.fromaxis(&#39;R&#39;)</span>
<span class="c1">#test_data = exp(-R*t).dot(P)</span>
<span class="c1">#logger.debug(strm(&#39;when constructing test_data, shape of the data is&#39;,ndshape(test_data),&quot;len of axis_coords_error&quot;,len(test_data.axis_coords_error)))</span>
<span class="c1">#</span>
<span class="c1">##test_data += random.normal(scale = 0.01,size=(2048,1))</span>
<span class="c1">#test_data.add_noise(0.01)</span>
<span class="c1">#fl.next(&#39;test data function&#39;)</span>
<span class="c1">#fl.plot(test_data)</span>
<span class="c1">#xlim(-time_endpoint/10,time_endpoint)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## Do the basic NNLS fit</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#logger.debug(strm(&#39;before nnls, shape of the data is&#39;,ndshape(test_data),&quot;len of axis_coords_error&quot;,len(test_data.axis_coords_error)))</span>
<span class="c1">#test_fit = test_data.C.nnls(&#39;t&#39;,R,lambda x,y: exp(-y*x))</span>
<span class="c1">#fl.next(&#39;fit an exponential distribution&#39;,legend=True)</span>
<span class="c1">#fl.plot(test_data, alpha=0.5, label=&#39;test signal&#39;)</span>
<span class="c1">#K = test_fit.get_prop(&#39;nnls_kernel&#39;).C</span>
<span class="c1">##note that order doesn&#39;t matter for the following dot (done by dimension name)</span>
<span class="c1">#fl.plot(test_fit.C.dot(K), alpha=0.5, label=&#39;fit&#39;)</span>
<span class="c1">#fl.next(&#39;what does the fit distribution look like?&#39;)</span>
<span class="c1">#fl.plot(test_fit)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## Now add regularization</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#def L_curve(l,r_norm,x_norm, show_l=None, s=1e-3,</span>
<span class="c1">#        **kwargs):</span>
<span class="c1">#    &quot;&quot;&quot;plot L-curve using</span>
<span class="c1">#</span>
<span class="c1">#    Parameters</span>
<span class="c1">#    ==========</span>
<span class="c1">#    l: double</span>
<span class="c1">#        lambda values</span>
<span class="c1">#    r_norm: double</span>
<span class="c1">#        norm of the residual</span>
<span class="c1">#    x_norm: double</span>
<span class="c1">#        norm of solution vector&quot;&quot;&quot;</span>
<span class="c1">#    print(l.shape, r_norm.shape, x_norm.shape)</span>
<span class="c1">#    r_to_x = UnivariateSpline(log10(r_norm),log10(x_norm), s=s)</span>
<span class="c1">#    r_fine = linspace(*tuple(log10(r_norm[r_[0,-1]]).tolist()+[1000]))</span>
<span class="c1">#    plot(log10(r_norm),log10(x_norm),&#39;o&#39;,**kwargs)</span>
<span class="c1">#    a = gca().get_ylim()</span>
<span class="c1">#    plot(r_fine,r_to_x(r_fine), alpha=0.3)</span>
<span class="c1">#    gca().set_ylim(a)</span>
<span class="c1">#    if show_l is not None:</span>
<span class="c1">#        l_to_r = UnivariateSpline(l,log10(r_norm),s=1e-3)</span>
<span class="c1">#        this_r = l_to_r(show_l)</span>
<span class="c1">#        this_x = r_to_x(this_r)</span>
<span class="c1">#        OLDplot(this_r,this_x,&#39;ro&#39;)</span>
<span class="c1">#        annotate(&#39;chosen $\lambda=%3g$&#39;%show_l, (this_r,this_x))</span>
<span class="c1">#    for j,this_l in enumerate(l):</span>
<span class="c1">#        annotate(&#39;%5g&#39;%this_l, (log10(r_norm[j]),log10(x_norm[j])),</span>
<span class="c1">#                 ha=&#39;left&#39;,va=&#39;bottom&#39;,rotation=45)</span>
<span class="c1">#    ylabel(&#39;$\log_{10}(x$ norm$)$&#39;)</span>
<span class="c1">#    xlabel(&#39;$\log_{10}($ residual $)$&#39;)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##l = sqrt(logspace(-8,4,10)) # I do this because it gives me a fairly even spacing of points</span>
<span class="c1">###@timeit</span>
<span class="c1">##def nonvec_lcurve(l):</span>
<span class="c1">##    x_norm = empty_like(l)</span>
<span class="c1">##    r_norm = empty_like(l)</span>
<span class="c1">##    for j,this_l in enumerate(l):</span>
<span class="c1">##        x = test_data.C.nnls(&#39;t&#39;,</span>
<span class="c1">##                R,lambda x,y: exp(-y*x), l=this_l)</span>
<span class="c1">##        r_norm[j] = x.get_prop(&#39;nnls_residual&#39;)</span>
<span class="c1">##        x_norm[j] = linalg.norm(x.data)</span>
<span class="c1">##    return x,x_norm,r_norm</span>
<span class="c1">##x,x_norm,r_norm = nonvec_lcurve(l)</span>
<span class="c1">###x_norm = map(linalg.norm,x) # to be fair, this calculation is done outside the timing, below</span>
<span class="c1">##</span>
<span class="c1">##</span>
<span class="c1">###</span>
<span class="c1">##</span>
<span class="c1">##</span>
<span class="c1">##fl.next(&#39;L-curve&#39;, legend=True);clf()</span>
<span class="c1">##L_curve(l, r_norm, x_norm, markersize=10, alpha=0.5, label=&#39;manual loop&#39;)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## ## Vectorized version of lambda curve</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#l = sqrt(logspace(-8,4,10)) # I do this because it gives me a fairly even spacing of points</span>
<span class="c1">##@timeit</span>
<span class="c1">#def vec_lcurve(l):</span>
<span class="c1">#    return test_data.C.nnls(&#39;t&#39;,</span>
<span class="c1">#            R,lambda x,y: exp(-y*x), l=l)</span>
<span class="c1">#x = vec_lcurve(l)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#fl.next(&#39;L-curve&#39;)</span>
<span class="c1">#logger.debug(strm(&quot;check dtype of residual:&quot;,x.get_prop(&#39;nnls_residual&#39;).data.dtype))</span>
<span class="c1">#L_curve(l, x.get_prop(&#39;nnls_residual&#39;).data, x.C.run(linalg.norm,&#39;R&#39;).data,</span>
<span class="c1">#        markersize=5, alpha=0.5, label=&#39;compiled loop&#39;)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## ## 1.5D example -- very simplistic dataset</span>
<span class="c1">##</span>
<span class="c1">## (where the data is duplicated along the $\Omega$ dimension)</span>
<span class="c1">##</span>
<span class="c1">## unlike for the numpy version, I skip straight to the</span>
<span class="c1">## vectorized/parallel version.</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#l = sqrt(logspace(-8,4,10)) # I do this because it gives me a fairly even spacing of points</span>
<span class="c1">#test_data_2d = test_data * nddata(r_[1,1,1],r&#39;\Omega&#39;)</span>
<span class="c1">##@timeit</span>
<span class="c1">#def multifreq_lcurve(l):</span>
<span class="c1">#    return test_data_2d.C.nnls(&#39;t&#39;,</span>
<span class="c1">#            R,lambda x,y: exp(-y*x), l=l)</span>
<span class="c1">#x = multifreq_lcurve(l)</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#fl.next(&#39;L-curve&#39;)</span>
<span class="c1">#chosen_l = 0.025</span>
<span class="c1">#L_curve(l, x.get_prop(&#39;nnls_residual&#39;)[r&#39;\Omega&#39;,0].data,</span>
<span class="c1">#        x.C.run(linalg.norm,&#39;R&#39;)[r&#39;\Omega&#39;,0].data, markersize=5, alpha=0.5,</span>
<span class="c1">#        show_l=chosen_l,</span>
<span class="c1">#        label=&#39;compiled loop&#39;)</span>
<span class="c1">#</span>
<span class="c1">## and show the final result</span>
<span class="c1">## here, I omit the SVD (allows negative) result</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#fl.next(r&#39;show result where $\lambda$ set to knee&#39;)</span>
<span class="c1">#test_data.nnls(&#39;t&#39;, R, lambda x,y: exp(-x*y), l=0.025)</span>
<span class="c1">#fl.plot(test_data)</span>
<span class="c1">#fl.plot(P)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## ## 1.5D code -- a more complicated/realistic example</span>
<span class="c1">##</span>
<span class="c1">## First, generate a test distribution, where we assume we have two dimensions:</span>
<span class="c1">##</span>
<span class="c1">## *  A $t_2$ dimension, which is actually typically a frequency dimension</span>
<span class="c1">## *  A $t_{indirect}$ dimension -- representing, *e.g.*, the delay of an inversion recovery experiment.</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#time_endpoint = 0.2</span>
<span class="c1">#R = nddata(r_[1.:100:100j],&#39;R&#39;) # distribution of T2 relaxation rates</span>
<span class="c1">#t2 = nddata(r_[1e-3:time_endpoint:2048j],&#39;t2&#39;) # column vectors give functions of time</span>
<span class="c1">#peaks_2D = [(20,1,0.8,0.025,5e-3,1),</span>
<span class="c1">#           (30,1,0.8,0.075,1e-2,1),</span>
<span class="c1">#           (80,5,1,0.175,1e-2,1)]</span>
<span class="c1">#data_dist = 0</span>
<span class="c1">#for x_mu,x_sigma,x_amp,y_mu,y_sigma,y_amp in peaks_2D:</span>
<span class="c1">#        data_dist += x_amp*y_amp*exp(-(R-x_mu)**2/2/x_sigma**2</span>
<span class="c1">#                           -(t2-y_mu)**2/2/y_sigma**2)</span>
<span class="c1">#fl.next(&#39;Test 1.5D true distribution&#39;)</span>
<span class="c1">#fl.image(data_dist)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## Convert to the time domain, where the $R$ dimension is replaced by a</span>
<span class="c1">## $t_{indirect}$ dimension, and add noise</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#n_indirect = 128</span>
<span class="c1">#t_indirect = nddata((r_[0:n_indirect]+1)/double(n_indirect),</span>
<span class="c1">#        &#39;t_indirect&#39;)</span>
<span class="c1">#kernel = exp(-t_indirect*R)</span>
<span class="c1">#test_data_2d = kernel.C.dot(data_dist)</span>
<span class="c1">#fl.next(&#39;Test 1.5D dataset&#39;)</span>
<span class="c1">#test_data_2d.add_noise(0.1)</span>
<span class="c1">#fl.image(test_data_2d)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## Generate the L-curve</span>
<span class="c1">#</span>
<span class="c1">#l = sqrt(logspace(-8,4,10))</span>
<span class="c1">##@timeit</span>
<span class="c1">#def multifreq_lcurve(l):</span>
<span class="c1">#    return test_data_2d.C.nnls(&#39;t_indirect&#39;,</span>
<span class="c1">#            R,lambda x,y: exp(-y*x), l=l)</span>
<span class="c1">#x = multifreq_lcurve(l)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#print(ndshape(test_data_2d))</span>
<span class="c1">#print(ndshape(x))</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#fl.next(&#39;L-curve&#39;)</span>
<span class="c1">#heel_lambda = 0.215</span>
<span class="c1">#L_curve(l, x.get_prop(&#39;nnls_residual&#39;).C.sum(&#39;t2&#39;).data,</span>
<span class="c1">#        x.C.run(linalg.norm,&#39;R&#39;).sum(&#39;t2&#39;).data, markersize=5, alpha=0.5,</span>
<span class="c1">#        label=&#39;compiled loop&#39;,</span>
<span class="c1">#        show_l=heel_lambda, s=1e-2)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## Final result for 1.5D test data</span>
<span class="c1">#</span>
<span class="c1">#fl.next(r&#39;show result where $\lambda$ set to knee&#39;)</span>
<span class="c1">#result = test_data_2d.C.nnls(&#39;t_indirect&#39;,R,</span>
<span class="c1">#                    lambda x,y: exp(-y*x), l=heel_lambda)</span>
<span class="c1">#fl.image(result)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">## ## Testing 2D BRD extension</span>

<span class="k">def</span> <span class="nf">Gaussian_2D</span><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis</span></a><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis</span></a><span class="p">,</span><span class="n">mu_x</span><span class="p">,</span><span class="n">mu_y</span><span class="p">,</span><span class="n">sigma_x</span><span class="p">,</span><span class="n">sigma_y</span><span class="p">):</span>
    <span class="n">this_Gaussian</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis</span></a><span class="o">-</span><span class="n">mu_x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma_x</span><span class="o">**</span><span class="mi">2</span>
                        <span class="o">-</span><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis</span></a><span class="o">-</span><span class="n">mu_y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">this_Gaussian</span>
<span class="k">def</span> <span class="nf">Gaussian_2D_corr</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis</span></a><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis</span></a><span class="p">,</span><span class="n">mu_x</span><span class="p">,</span><span class="n">mu_y</span><span class="p">,</span><span class="n">sigma_x</span><span class="p">,</span><span class="n">sigma_y</span><span class="p">):</span>
    <span class="n">diff_xy</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis</span></a> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis</span></a>
    <span class="n">sum_xy</span> <span class="o">=</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis</span></a> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis</span></a>
    <span class="n">diff_mu</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">mu_x</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">mu_y</span>
    <span class="n">sum_mu</span> <span class="o">=</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">mu_x</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">mu_y</span>
    <span class="n">this_Gaussian</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">diff_xy</span><span class="o">-</span><span class="n">diff_mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma_x</span><span class="o">**</span><span class="mi">2</span>
                       <span class="o">-</span><span class="p">(</span><span class="n">sum_xy</span><span class="o">-</span><span class="n">sum_mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">this_Gaussian</span>

<span class="n">Nx</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">Ny</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">x_min</span> <span class="o">=</span> <span class="mf">3e-3</span><span class="p">;</span> <span class="n">x_max</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">y_min</span> <span class="o">=</span> <span class="mf">3e-3</span><span class="p">;</span> <span class="n">y_max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis_log</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class"><span class="n">nddata</span></a><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="n">x_min</span><span class="p">),</span><span class="n">log10</span><span class="p">(</span><span class="n">x_max</span><span class="p">),</span><span class="n">Nx</span><span class="p">),</span><span class="sa">r</span><span class="s1">&#39;log(T1)&#39;</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis_log</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class"><span class="n">nddata</span></a><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="n">y_min</span><span class="p">),</span><span class="n">log10</span><span class="p">(</span><span class="n">y_max</span><span class="p">),</span><span class="n">Ny</span><span class="p">),</span><span class="sa">r</span><span class="s1">&#39;log(T2)&#39;</span><span class="p">)</span>

<a href="../auto_api/pyspecdata.html#pyspecdata.figlist.next" title="pyspecdata.figlist.next" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">fl</span><span class="o">.</span><span class="n">next</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;True $T_</span><span class="si">{1}</span><span class="s1">$,$T_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dist</span></a> <span class="o">=</span> <span class="n">Gaussian_2D</span><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis_log</span></a><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis_log</span></a><span class="p">,</span><span class="o">-</span><span class="mf">1.6</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dist</span></a> <span class="o">+=</span> <span class="n">Gaussian_2D_corr</span><span class="p">(</span><span class="o">-</span><span class="mi">195</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis_log</span></a><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis_log</span></a><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dist</span></a> <span class="o">+=</span> <span class="n">Gaussian_2D_corr</span><span class="p">(</span><span class="o">-</span><span class="mi">115</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis_log</span></a><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis_log</span></a><span class="p">,</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0.09</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
<a href="../auto_api/pyspecdata.html#pyspecdata.figlist.image" title="pyspecdata.figlist.image" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">fl</span><span class="o">.</span><span class="n">image</span></a><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dist</span></a><span class="p">)</span>

<span class="n">N_tau1</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">N_tau2</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">tau1_min</span> <span class="o">=</span> <span class="mf">5e-4</span><span class="p">;</span> <span class="n">tau1_max</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">tau2_min</span> <span class="o">=</span> <span class="mf">5e-4</span><span class="p">;</span> <span class="n">tau2_max</span> <span class="o">=</span> <span class="mf">1.2</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tau1_axis</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class"><span class="n">nddata</span></a><span class="p">(</span><span class="n">logspace</span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="n">tau1_min</span><span class="p">),</span><span class="n">log10</span><span class="p">(</span><span class="n">tau1_max</span><span class="p">),</span><span class="n">N_tau1</span><span class="p">),</span><span class="s1">&#39;tau1&#39;</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tau2_axis</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class"><span class="n">nddata</span></a><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="n">tau2_min</span><span class="p">,</span><span class="n">tau2_max</span><span class="p">,</span><span class="n">N_tau2</span><span class="p">),</span><span class="s1">&#39;tau2&#39;</span><span class="p">)</span>

<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dist</span></a><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tau2_axis</span></a><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis_log</span></a><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tau1_axis</span></a><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis_log</span></a><span class="p">)))</span>
<a href="../pyspecdata.html#pyspecdata.nddata.sum" title="pyspecdata.nddata.sum" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">s</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><span class="s1">&#39;log(T1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;log(T2)&#39;</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="o">/=</span> <span class="n">amax</span><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata.add_noise" title="pyspecdata.nddata.add_noise" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">s</span><span class="o">.</span><span class="n">add_noise</span></a><span class="p">(</span><span class="mf">0.03</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata.reorder" title="pyspecdata.nddata.reorder" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">s</span><span class="o">.</span><span class="n">reorder</span></a><span class="p">(</span><span class="s1">&#39;tau1&#39;</span><span class="p">)</span>
<a href="../auto_api/pyspecdata.html#pyspecdata.figlist.next" title="pyspecdata.figlist.next" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">fl</span><span class="o">.</span><span class="n">next</span></a><span class="p">(</span><span class="s1">&#39;2D test data&#39;</span><span class="p">)</span>
<a href="../auto_api/pyspecdata.html#pyspecdata.figlist.image" title="pyspecdata.figlist.image" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">fl</span><span class="o">.</span><span class="n">image</span></a><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a><span class="p">)</span>

<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class"><span class="n">nddata</span></a><span class="p">(</span><span class="mi">10</span><span class="o">**</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis_log</span></a><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="s1">&#39;T1&#39;</span><span class="p">)</span>
<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class"><span class="n">nddata</span></a><span class="p">(</span><span class="mi">10</span><span class="o">**</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis_log</span></a><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="s1">&#39;T2&#39;</span><span class="p">)</span>

<a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">solution</span></a> <span class="o">=</span> <a href="../pyspecdata.html#pyspecdata.nddata.C" title="pyspecdata.nddata.C" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-property"><span class="n">s</span><span class="o">.</span><span class="n">C</span><span class="o">.</span><span class="n">nnls</span></a><span class="p">((</span><span class="s1">&#39;tau1&#39;</span><span class="p">,</span><span class="s1">&#39;tau2&#39;</span><span class="p">),</span>
             <span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_axis</span></a><span class="p">,</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_axis</span></a><span class="p">),</span>
             <span class="p">(</span><span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">:</span> <span class="mf">1.</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">/</span><span class="n">x2</span><span class="p">),</span>
             <span class="k">lambda</span> <span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y1</span><span class="o">/</span><span class="n">y2</span><span class="p">)),</span>
             <span class="n">l</span><span class="o">=</span><span class="s1">&#39;BRD&#39;</span><span class="p">)</span>

<a href="../auto_api/pyspecdata.html#pyspecdata.figlist.next" title="pyspecdata.figlist.next" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">fl</span><span class="o">.</span><span class="n">next</span></a><span class="p">(</span><span class="s1">&#39;Solution&#39;</span><span class="p">)</span>
<a href="../auto_api/pyspecdata.html#pyspecdata.figlist.image" title="pyspecdata.figlist.image" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">fl</span><span class="o">.</span><span class="n">image</span></a><span class="p">(</span><a href="../pyspecdata.html#pyspecdata.nddata" title="pyspecdata.nddata" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">solution</span></a><span class="p">)</span>
<span class="c1">#</span>
<span class="k">if</span> <span class="n">in_notebook</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;in notebook, not calling show&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;not in notebook, calling show&quot;</span><span class="p">)</span>
    <a href="../auto_api/pyspecdata.html#pyspecdata.figlist.show" title="pyspecdata.figlist.show" class="sphx-glr-backref-module-pyspecdata sphx-glr-backref-type-py-method"><span class="n">fl</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (31 minutes 21.596 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-nddata-nnls-tikhonov-190104-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/8a53d56ef1dd72399eb643aab15545fb/nddata_NNLS_Tikhonov_190104.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">nddata_NNLS_Tikhonov_190104.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/4c532aa5d95815ba9105fc85da5d409a/nddata_NNLS_Tikhonov_190104.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">nddata_NNLS_Tikhonov_190104.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/pyspec_path_equaltip.png" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nddata.html">ND-Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitdata.html">the lmfitdata class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">List of Modules and Sub-Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook.html">LaTeX Notebook Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../figlist.html">The Figure List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">Units</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Gallery</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">PySpecData Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Cary_simple.html">Simple Cary UV-Vis loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="pcolor_example.html">Unevenly spaced data</a></li>
<li class="toctree-l2"><a class="reference internal" href="esr_example.html">Bruker cw ESR Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="polyfit.html">Polynomial Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppm_2D.html">PPM in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculate_covariance.html">Calculation of the Covariance Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="convolution.html">Simple Convolution Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_plot.html">Plotting Routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppm_example.html">ppm Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="ellmans.html">Manipulation of UV-Vis data</a></li>
<li class="toctree-l2"><a class="reference internal" href="fit_with_bounds.html">Fit Using Bounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="fit_complex.html">Fit complex data</a></li>
<li class="toctree-l2"><a class="reference internal" href="DCCT_function.html">Using the DCCT function</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_example.html">Basic Slicing/Filtering Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="fit_complex_with_transform.html">Fit complex data with transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="BRD_test.html">1D BRD regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="BSA_calibration.html">BSA UV-Vis Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="fit_fake_data.html">Fitting Data (Nonlinear + Symbolic)</a></li>
<li class="toctree-l2"><a class="reference internal" href="QESR.html">Quantitative ESR</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2D ILT test</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#individual-functions">Individual Functions</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">PySpecData Examples</a><ul>
      <li>Previous: <a href="QESR.html" title="previous chapter">Quantitative ESR</a></li>
      <li>Next: <a href="indiv_funcs/index.html" title="next chapter">Individual Functions</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2016, John M. Franck.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/auto_examples/nddata_NNLS_Tikhonov_190104.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>